modificacion completa pero no funcional
